<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ice Cream Social Pricing Calculator</title>
    <style>
        body {
            margin: 0;
            font-family: sans-serif;
            font-size: 24px;
            user-select: none;
        }
        #app {
            display: grid;
            grid-template-columns: 1fr 15em;
            height: 100vh;
        }
        #app div.buttons {
            display: grid;
            grid-template-columns: 50% 50%;
            height: 100vh;
            justify-content: center;
        }
        button {
            border: 1px solid black;
            margin: 0.5rem;
            font-size: 2em;
        }
        #app div.buttons.sub button:disabled {
            color: lightgray;
        }
        #app div.buttons.sub button:not(:disabled) {
            color: red;
        }
        #app div.summary {
            overflow: auto;
            display: flex;
            flex-direction: column;
        }
        #app div.summary ul {
            padding-left: 20px;
            flex-grow: 1;
        }
        #total {
            font-size: 2em;
            margin: 0;
        }
        #postcard {
            color: red;
        }
    </style>
</head>
<script src="https://unpkg.com/vue@3"></script>

<div id="app">
    <div class="buttons" :class="{ add: addMode, sub: !addMode }">
        <button
            v-for="item in items"
            :disabled="!addMode && item.quantity == 0"
            @click="if (addMode) { item.quantity++; } else { item.quantity--; addMode=true; }"
        >{{ item.name }}: {{ priceFormatter.format(item.cost) }}</button>
    </div>
    <div class="summary">
        <ul>
            <li v-for="item in items" v-show="item.quantity != 0">{{ item.name }} ({{ item.quantity }}): {{ priceFormatter.format(item.cost * item.quantity) }}</li>
        </ul>
        <p v-if="postcards > 0" id="postcard">&ndash;{{ priceFormatter.format(discount()) }} ({{ postcards }} postcards)</p>
        <p id="total">Total: {{ priceFormatter.format(total() - discount()) }}</p>
        <button @click="items.forEach(item => item.quantity = 0)">Reset</button>
        <button @click="addMode=!addMode">Minus</button>
        <button :disabled="!addMode && postcards == 0"
            @click="if (addMode) { postcards++; } else { postcards--; addMode=true; }">$7 off</button>
    </div>
</div>

<script>
    const { createApp } = Vue;

    const app = createApp({
        data() {
            return {
                addMode: true,
                postcards: 0,
                items: [
                    {
                        name: "Turkey Salad",
                        cost: 4,
                        quantity: 0,
                    },
                    {
                        name: "BBQ",
                        cost: 4,
                        quantity: 0,
                    },
                    {
                        name: "Beans",
                        cost: 0.75,
                        quantity: 0,
                    },
                    {
                        name: "Potato Salad",
                        cost: 2,
                        quantity: 0,
                    },
                    {
                        name: "Pickles",
                        cost: 0,
                        quantity: 0,
                    },
                    {
                        name: "Cake",
                        cost: 1.5,
                        quantity: 0,
                    },
                    {
                        name: "Cake à la mode",
                        cost: 2.25,
                        quantity: 0,
                    },
                    {
                        name: "Pie",
                        cost: 2,
                        quantity: 0,
                    },
                    {
                        name: "Pie à la mode",
                        cost: 2.75,
                        quantity: 0,
                    },
                    {
                        name: "Root Beer Float",
                        cost: 2,
                        quantity: 0,
                    },
                    {
                        name: "Root Beer",
                        cost: 1,
                        quantity: 0,
                    },
                    {
                        name: "Milk",
                        cost: 1,
                        quantity: 0,
                    },
                    {
                        name: "Egg Coffee",
                        cost: 0.5,
                        quantity: 0,
                    },
                    {
                        name: "Bottled Water",
                        cost: 1,
                        quantity: 0,
                    },
                ],
                priceFormatter: new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }),
            };
        },
        methods: {
            discount() {
                return Math.min(this.total(), 7 * this.postcards);
            },
            total() {
                return this.items.reduce((total, item) => total + item.cost * item.quantity, 0);
            }
        }
    }).mount('#app');
</script>

</html>
